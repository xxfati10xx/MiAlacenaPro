<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>MiAlacena Pro</title>
    <link rel="manifest" href="manifest.json">
    <meta name="theme-color" content="#059669">
    
    <!-- Librerías Necesarias -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    
    <!-- Firebase SDK (Módulos) -->
    <script type="importmap">
    {
      "imports": {
        "firebase/app": "https://www.gstatic.com/firebasejs/11.2.0/firebase-app.js",
        "firebase/auth": "https://www.gstatic.com/firebasejs/11.2.0/firebase-auth.js",
        "firebase/firestore": "https://www.gstatic.com/firebasejs/11.2.0/firebase-firestore.js"
      }
    }
    </script>

    <style>
        body { overscroll-behavior-y: contain; background: #f1f5f9; font-family: ui-sans-serif, system-ui, sans-serif; }
        .no-scrollbar::-webkit-scrollbar { display: none; }
        .glass { background: rgba(255, 255, 255, 0.9); backdrop-filter: blur(16px); }
        .animate-in { animation: fadeIn 0.3s ease-out forwards; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="module">
        // Importamos Firebase para que la lógica de la app funcione
        import { initializeApp } from 'firebase/app';
        import { getAuth, signInAnonymously, onAuthStateChanged } from 'firebase/auth';
        import { getFirestore, collection, onSnapshot, addDoc, updateDoc, doc } from 'firebase/firestore';

        // Exportamos a window para que Babel pueda acceder a ellos
        window.FB = { initializeApp, getAuth, signInAnonymously, onAuthStateChanged, getFirestore, collection, onSnapshot, addDoc, updateDoc, doc };
    </script>

    <script type="text/babel">
        // Inyectamos los iconos Lucide como SVGs internos para evitar dependencias de red pesadas
        const Icons = {
            ShoppingBasket: (props) => <svg {...props} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="m5 11 4-7"/><path d="m19 11-4-7"/><path d="M2 11h20"/><path d="m3.5 11 1.6 7.4a2 2 0 0 0 2 1.6h9.8c.9 0 1.8-.7 2-1.6l1.7-7.4"/><path d="M9 11v5"/><path d="M15 11v5"/></svg>,
            Settings: (props) => <svg {...props} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z"/><circle cx="12" cy="12" r="3"/></svg>,
            LayoutGrid: (props) => <svg {...props} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><rect width="7" height="7" x="3" y="3" rx="1"/><rect width="7" height="7" x="14" y="3" rx="1"/><rect width="7" height="7" x="14" y="14" rx="1"/><rect width="7" height="7" x="3" y="14" rx="1"/></svg>,
            Plus: (props) => <svg {...props} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M5 12h14"/><path d="M12 5v14"/></svg>,
            Minus: (props) => <svg {...props} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M5 12h14"/></svg>,
            Search: (props) => <svg {...props} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><circle cx="11" cy="11" r="8"/><path d="m21 21-4.3-4.3"/></svg>
        };

        const config = {"apiKey":"AIzaSyCqyCcs2R2e7AegGjvFAwG98wlamtbHvZY","authDomain":"bard-frontend.firebaseapp.com","projectId":"bard-frontend","storageBucket":"bard-frontend.firebasestorage.app","messagingSenderId":"175205271074","appId":"1:175205271074:web:2b7bd4d34d33bf38e6ec7b"};
        const appId = "c_cc6c1a3c626eebdf_App.tsx-209";

        function App() {
            const [products, setProducts] = React.useState([]);
            const [activeTab, setActiveTab] = React.useState('pantry');
            const [user, setUser] = React.useState(null);
            
            React.useEffect(() => {
                const app = window.FB.initializeApp(config);
                const auth = window.FB.getAuth(app);
                const db = window.FB.getFirestore(app);
                
                window.FB.signInAnonymously(auth).then(() => {
                    window.FB.onAuthStateChanged(auth, setUser);
                });

                const q = window.FB.collection(db, 'artifacts', appId, 'public', 'data', 'pantry');
                return window.FB.onSnapshot(q, (snap) => {
                    setProducts(snap.docs.map(d => ({...d.data(), id: d.id})));
                });
            }, []);

            return (
                <div className="min-h-screen bg-[#F8FAFC] flex flex-col max-w-md mx-auto shadow-2xl overflow-hidden">
                    <header className="glass p-5 pt-8 z-20 border-b flex justify-between items-center">
                        <div className="flex items-center gap-3">
                            <div className="bg-emerald-600 p-2.5 rounded-2xl text-white"><Icons.ShoppingBasket /></div>
                            <h1 className="text-xl font-black">MiAlacena <span className="text-emerald-600">Pro</span></h1>
                        </div>
                        <Icons.Settings className="text-slate-400" />
                    </header>
                    
                    <main className="flex-1 p-5 overflow-y-auto space-y-4 no-scrollbar">
                        <div className="relative">
                            <Icons.Search className="absolute left-4 top-1/2 -translate-y-1/2 text-slate-300" size={18} />
                            <input className="w-full pl-12 pr-4 py-4 bg-white rounded-2xl outline-none shadow-sm" placeholder="Buscar..." />
                        </div>
                        {products.map(p => (
                            <div key={p.id} className="bg-white p-4 rounded-3xl border flex items-center gap-4">
                                <div className="flex-1 font-bold">{p.name}</div>
                                <div className="flex items-center bg-slate-50 rounded-xl p-1">
                                    <button className="w-8 h-8 flex items-center justify-center bg-white rounded-lg"><Icons.Minus size={14}/></button>
                                    <span className="w-8 text-center font-black">{p.currentStock}</span>
                                    <button className="w-8 h-8 flex items-center justify-center bg-white rounded-lg"><Icons.Plus size={14}/></button>
                                </div>
                            </div>
                        ))}
                    </main>

                    <nav className="glass border-t h-20 flex justify-around items-center px-4">
                        <button className="text-emerald-600 flex flex-col items-center"><Icons.LayoutGrid size={22}/><span className="text-[9px] font-black uppercase">Stock</span></button>
                        <button className="text-slate-400 flex flex-col items-center"><Icons.Plus size={22}/><span className="text-[9px] font-black uppercase">Añadir</span></button>
                    </nav>
                </div>
            );
        }

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>